name:           Build Test Deploy AWS Lambda

on:
  push:
    branches:
      - [ $default-branch ]

jobs:
  build:
    name:       Build
    runs-on:    ubuntu-latest

    container:
      image:    golang:latest

    steps:
    - name:     Checkout
      uses:     actions/checkout@v2.3.3
      with:
        path:   hello-lambda

    - name:     Setup Go environment
      uses:     actions/setup-go@v2.1.3
      with:
        go-version: '1.15.2'

    - name:     Build Lambda
      run:      |
        cd $GITHUB_WORKSPACE/${{ github.path }}/src/
        go get github.com/aws/aws-lambda-go/lambda
        GOOS=linux go build main.go
